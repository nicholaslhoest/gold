---
import { getCollection, getEntryBySlug, render } from 'astro:content';
import "../../styles/global.css";
import PaperLayout from "../../layouts/PaperLayout.astro";
import BaseLayout from "../../layouts/BaseLayout.astro";
import Prose from "../../components/Prose.astro";

export async function getStaticPaths() {
    const papers = await getCollection("papers");
    return papers.map((paper) => ({
        params: { slug: paper.slug },
    }));
}

const { slug } = Astro.params;
const paper = await getEntryBySlug("papers", slug);

if (!paper) {
    throw new Error(`Paper not found: ${slug}`);
}

const { Content } = await render(paper);

const wpm = Math.round((paper.body.length/5)/214);

---
<BaseLayout title={paper.data.title}>
    <PaperLayout
            date={paper.data.date}
            time={wpm}
            keys={paper.data.keys}
            collection={paper.data.collection}
    >
        <Prose>
            <Content />
        </Prose>
    </PaperLayout>
</BaseLayout>

