---
import { getCollection, getEntryBySlug, render } from 'astro:content';
import "../../styles/global.css";
import PoemLayout from "../../layouts/PoemLayout.astro";
import BaseLayout from "../../layouts/BaseLayout.astro";
import Prose from "../../components/Prose.astro";

export async function getStaticPaths() {
    const poemCollection = await getCollection("poems");
    return poemCollection.map((poem) => ({
        params: { slug: poem.slug },
    }));
}

const { slug } = Astro.params;
const poem = await getEntryBySlug("poems", slug);

if (!poem) {
    throw new Error(`Paper not found: ${slug}`);
}

const { Content } = await render(poem);  // Render Markdown body content

const inputString = poem.slug;

// Split by hyphen
const parts = inputString.split('-');

// Get the middle value (index 1)
const middleValue = parts[1];

---
<BaseLayout>
    <PoemLayout
            number={middleValue}
            title={poem.data.title}
            date={poem.data.date}
    >
        <Prose>
            <Content />
        </Prose>
    </PoemLayout>
</BaseLayout>

